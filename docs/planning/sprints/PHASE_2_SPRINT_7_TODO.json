{
  "phase": 2,
  "sprint": 7,
  "title": "Working Memory Promotion",
  "priority": "HIGH",
  "effort": "5 hours",
  "status": "completed",
  "completedAt": "2026-01-13",
  "implementationNotes": "All tasks completed. Enhanced markForPromotion with PromotionMarkOptions, enhanced getPromotionCandidates with priority-based sorting and PromotionCriteria, implemented promoteMemory for workingâ†’episodic/semantic conversion, and confirmMemory with auto-promotion trigger. 26 new tests added (total 58 for WorkingMemoryManager).",
  "impact": "Enables transition from temporary working memory to permanent long-term storage",
  "targetMetrics": {
    "promotionAccuracy": {
      "current": "No promotion pipeline",
      "target": "Confidence-based and manual promotion pathways",
      "achieved": "Both manual and auto-promotion pathways implemented"
    },
    "dataIntegrity": {
      "current": "N/A",
      "target": "100% data preservation during promotion",
      "achieved": "100% data preserved, working memory fields cleared appropriately"
    }
  },
  "tasks": [
    {
      "id": "2.7.1",
      "category": "core",
      "title": "Implement markForPromotion() Method",
      "description": "Set flag on working memory indicating it's a candidate for promotion to long-term storage.",
      "status": "completed",
      "implementationNotes": "Enhanced with PromotionMarkOptions for targetType specification. Adds promote_to_{type} tag for workflow tracking.",
      "estimatedHours": 0.75,
      "agent": "claude",
      "files": ["src/agent/WorkingMemoryManager.ts"],
      "testCategories": ["unit"],
      "acceptanceCriteria": [
        "Sets markedForPromotion: true",
        "Validates entity exists",
        "Validates entity is working memory",
        "Supports target type specification",
        "Persists changes",
        "Unit tests pass"
      ]
    },
    {
      "id": "2.7.2",
      "category": "core",
      "title": "Implement getPromotionCandidates() Method",
      "description": "Return working memories meeting promotion criteria either by explicit marking or threshold criteria.",
      "status": "completed",
      "implementationNotes": "Enhanced with PromotionCriteria interface. Priority-based sorting implemented: marked candidates get +100 priority, plus score-based priority from confidence, confirmations, and access count. includeMarked option added for filtering.",
      "estimatedHours": 1.0,
      "agent": "claude",
      "files": ["src/agent/WorkingMemoryManager.ts"],
      "testCategories": ["unit"],
      "acceptanceCriteria": [
        "Includes explicitly marked memories",
        "Includes memories meeting thresholds",
        "Sorted by promotion priority",
        "Configurable criteria",
        "Returns empty array when no candidates",
        "Unit tests pass"
      ]
    },
    {
      "id": "2.7.3",
      "category": "core",
      "title": "Implement Basic promoteMemory() Method",
      "description": "Convert working memory to target type by updating memoryType, clearing TTL fields, and setting promotion metadata.",
      "status": "completed",
      "implementationNotes": "Implemented with full data preservation. Clears expiresAt, isWorkingMemory, markedForPromotion. Sets promotedAt timestamp and promotedFrom with session ID. Removes promote_to_* tags. Removes entity from session index.",
      "estimatedHours": 1.25,
      "agent": "claude",
      "files": ["src/agent/WorkingMemoryManager.ts"],
      "testCategories": ["unit", "integration"],
      "acceptanceCriteria": [
        "Updates memoryType to target",
        "Clears expiresAt",
        "Clears isWorkingMemory",
        "Sets promotedAt timestamp",
        "Sets promotedFrom with session ID",
        "Removes from session index",
        "Preserves all other data",
        "Unit and integration tests pass"
      ]
    },
    {
      "id": "2.7.4",
      "category": "types",
      "title": "Create WorkingMemoryOptions Type in agent-memory.ts",
      "description": "Define and export WorkingMemoryOptions interface in shared types file with comprehensive documentation.",
      "status": "completed",
      "implementationNotes": "WorkingMemoryOptions already defined in agent-memory.ts from Sprint 6. Exported from types/index.ts.",
      "estimatedHours": 0.5,
      "agent": "claude",
      "files": ["src/types/agent-memory.ts"],
      "testCategories": ["typecheck"],
      "acceptanceCriteria": [
        "WorkingMemoryOptions in agent-memory.ts",
        "Comprehensive JSDoc with example",
        "Exported from types/index.ts",
        "WorkingMemoryManager updated",
        "npm run typecheck passes"
      ]
    },
    {
      "id": "2.7.5",
      "category": "core",
      "title": "Add Auto-Promotion Trigger",
      "description": "Implement automatic promotion when memory reaches confirmation threshold during update operations.",
      "status": "completed",
      "implementationNotes": "confirmMemory() method implemented with optional confidence boost. Auto-promotion to semantic memory triggered when both confidence and confirmation thresholds met (if autoPromote enabled). Returns ConfirmationResult with confirmed and promoted flags.",
      "estimatedHours": 1.5,
      "agent": "claude",
      "files": ["src/agent/WorkingMemoryManager.ts"],
      "testCategories": ["unit", "integration"],
      "acceptanceCriteria": [
        "confirmMemory increments confirmation count",
        "Optional confidence boost applied",
        "Auto-promotion triggered when thresholds met",
        "Returns promotion status",
        "Can be disabled via config",
        "Unit and integration tests pass"
      ]
    }
  ],
  "successCriteria": [
    "All five tasks completed with passing tests",
    "Memories can be marked for promotion",
    "Promotion candidates correctly identified",
    "Working memory successfully promoted to episodic/semantic",
    "Auto-promotion works when configured",
    "Data integrity preserved during promotion",
    "12+ unit tests pass"
  ],
  "filesCreated": [],
  "filesModified": [
    "src/agent/WorkingMemoryManager.ts",
    "src/agent/index.ts",
    "tests/unit/agent/WorkingMemoryManager.test.ts"
  ],
  "totalNewTests": 26,
  "totalEstimatedHours": 5,
  "dependencies": ["Sprint 6 - Working Memory Manager Foundation"],
  "notes": [
    "Promotion is one-way - no demotion back to working memory",
    "promotedFrom tracks provenance for audit trails",
    "Auto-promotion defaults to semantic for high-confidence facts",
    "New interfaces exported: PromotionMarkOptions, PromotionCriteria, PromotionResult, ConfirmationResult"
  ]
}
